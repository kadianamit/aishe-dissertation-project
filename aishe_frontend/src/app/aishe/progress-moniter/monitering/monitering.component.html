<div class="container-fluid reg-page-bg pl-4 pr-4">
    <div class="form-group">
        <div class="form-row mr-0 ml-0">
            <div class="col-md-12 mt-0 badges p-2 mt-3">
                <div class="float-left">
                    <span class="font-weight-bold text-lg">Progress Monitoring</span>
                </div>
            </div>
        </div>
    </div>
    <div class="animated fadeInDown card mb-2 pt-2 pb-1 bg-light overflow-hidden">
        <div class="row col-md-12 overflow-hidden">
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>Survey Year:</mat-label>
                    <mat-select [(ngModel)]="surveyYear">
                        <mat-option *ngFor="let item of surveyYearList" [value]="item.surveyYearValue">{{
                            item.surveyYearValue }}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>Form Type:</mat-label>
                    <mat-select [(ngModel)]="instituteType" [disabled]="
              roleId === '7' ||
              roleId === '2' ||
              roleId === '8' ||
              roleId === '9' ||
              roleId === '10' ||
              roleId === '11'
            ">
                        <mat-option value="ALL">--ALL--</mat-option>
                        <mat-option value="COLLEGE">--College--</mat-option>
                        <mat-option value="UNIVERSITY">--University--</mat-option>
                        <mat-option value="STANDALONE">--Standalone--</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>State:</mat-label>
                    <mat-select placeholder="--Select State--" [(ngModel)]="states" [disabled]="
              roleId === '6' ||
              roleId === '8' ||
              roleId === '9' ||
              roleId === '10' ||
              roleId === '11'
            ">
                        <mat-select-filter [array]="variables" [displayMember]="'name'"
                            (filteredReturn)="stateList = $event">
                        </mat-select-filter>
                        <mat-option *ngFor="let data of stateList" [value]="data.stateCode">{{ data.name }}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>From Date:</mat-label>
                    <input matInput [matDatepicker]="picker1" readonly [max]="maxDate" [(ngModel)]="fromDate"
                        placeholder="From Date" (dateChange)="handleToDate($event)" />
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>To Date:</mat-label>
                    <input matInput [matDatepicker]="picker2" readonly [min]="minDate" [max]="maxDate"
                        [(ngModel)]="toDate" placeholder="From Date" />
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
                    (click)="getProgressMoniter()">
                    <i class="fa fa-search" aria-hidden="true"></i>
                </button>
                <button mat-button class="btn btn-danger btn-sm mt-2 ml-2" matTooltip="Refresh" (click)="reload()">
                    <mat-icon matTooltip="Refresh">refresh</mat-icon>
                </button>
            </div>
            <!-- <div class="col-md-1">
                <button mat-button class="btn btn-sm btn-danger d-block mt-2" matTooltip="Refresh" (click)="reload()">
                    <i class="fa fa-refresh" aria-hidden="true"></i>
                </button>
            </div> -->
        </div>
        <!-- <div class="row col-md-12 overflow-hidden"> -->
        <div class="col-md-12 table-responsive">
            <table class="table table-bordered table-sm">
                <tr>
                    <th>Form Type</th>
                    <th>Sub-Type</th>
                    <th>Forms Expected</th>
                    <th>Forms Submitted</th>
                    <th>(%)</th>
                    <th>Not Submitted</th>
                </tr>
                <ng-container *ngFor="
            let item of progressMoniterListU;
            let i = index;
            let first = first;
            let last = last
          ">
                    <tr>
                        <td>{{ item.formType }}</td>
                        <td>{{ item.typeName }}</td>
                        <td (click)="openPopUp(item, 'FORM_EXPECTED')"
                            [ngClass]="{ hyperlink: item.totalFormExpected !== 0 }">
                            {{ item.totalFormExpected }}
                        </td>
                        <td (click)="openPopUp(item, 'FORM_SUBMITTED')"
                            [ngClass]="{ hyperlink: item.totalFormUploaded !== 0 }">
                            {{ item.totalFormUploaded }}
                        </td>
                        <td>{{ item.totalFormExpectedPer }}</td>
                        <td (click)="openPopUp(item, 'PENDING')" [ngClass]="{ hyperlink: item.pendingForm !== 0 }">
                            {{ item.pendingForm }}
                        </td>
                    </tr>
                    <tr *ngIf="last" style="background: silver; font-weight: 600">
                        <td>University</td>
                        <td>Total</td>
                        <td>{{ totalFormExU }}</td>
                        <td>{{ totalFormUploadU }}</td>
                        <td>{{ totalFormExPerU }}</td>
                        <td>{{ totalFormPendingU }}</td>
                    </tr>
                </ng-container>
                <ng-container *ngFor="
            let item of progressMoniterListC;
            let i = index;
            let first = first;
            let last = last
          ">
                    <tr>
                        <td>{{ item.formType }}</td>
                        <td>{{ item.typeName }}</td>
                        <td (click)="openPopUp(item, 'FORM_EXPECTED')"
                            [ngClass]="{ hyperlink: item.totalFormExpected !== 0 }">
                            {{ item.totalFormExpected }}
                        </td>
                        <td (click)="openPopUp(item, 'FORM_SUBMITTED')"
                            [ngClass]="{ hyperlink: item.totalFormUploaded !== 0 }">
                            {{ item.totalFormUploaded }}
                        </td>
                        <td>{{ item.totalFormExpectedPer }}</td>
                        <td (click)="openPopUp(item, 'PENDING')" [ngClass]="{ hyperlink: item.pendingForm !== 0 }">
                            {{ item.pendingForm }}
                        </td>
                    </tr>
                    <tr *ngIf="last" style="background: silver; font-weight: 600">
                        <td>College</td>
                        <td>Total</td>
                        <td>{{ totalFormExC }}</td>
                        <td>{{ totalFormUploadC }}</td>
                        <td>{{ totalFormExPerC }}</td>
                        <td>{{ totalFormPendingC }}</td>
                    </tr>
                </ng-container>
                <ng-container *ngFor="
            let item of progressMoniterListS;
            let i = index;
            let first = first;
            let last = last
          ">
                    <tr>
                        <td>{{ item.formType }}</td>
                        <td>{{ item.typeName }}</td>
                        <td (click)="openPopUp(item, 'FORM_EXPECTED')"
                            [ngClass]="{ hyperlink: item.totalFormExpected !== 0 }">
                            {{ item.totalFormExpected }}
                        </td>
                        <td (click)="openPopUp(item, 'FORM_SUBMITTED')"
                            [ngClass]="{ hyperlink: item.totalFormUploaded !== 0 }">
                            {{ item.totalFormUploaded }}
                        </td>
                        <td>{{ item.totalFormExpectedPer }}</td>
                        <td (click)="openPopUp(item, 'PENDING')" [ngClass]="{ hyperlink: item.pendingForm !== 0 }">
                            {{ item.pendingForm }}
                        </td>
                    </tr>
                    <tr *ngIf="last" style="background: silver; font-weight: 600">
                        <td>Standalone</td>
                        <td>Total</td>
                        <td>{{ totalFormExS }}</td>
                        <td>{{ totalFormUploadS }}</td>
                        <td>{{ totalFormExPerS }}</td>
                        <td>{{ totalFormPendingS }}</td>
                    </tr>
                </ng-container>
            </table>
            <!-- </div> -->
        </div>
        <div class="row col-md-12 mt-2" *ngIf="roleId === this.sharedService.role['State Nodal Officer'] ||
        roleId === this.sharedService.role['University']||roleId === this.sharedService.role['Ministry of Education'] ||
     roleId === this.sharedService.role['SysAdmin']
      ">
            <div class="row col-md-12">
                <p class="ml-3" style="font-size: 17px">
                    <span style="font-weight: 500">View Final Submit Institution List :</span>&nbsp;&nbsp;&nbsp;<a
                        href="javascript:void(0)" (click)="downloadFinalSubmit('U', 'FINAL_SUBMITTED')">University</a>
                    |
                    <a href="javascript:void(0)" (click)="downloadFinalSubmit('C', 'FINAL_SUBMITTED')">College</a>
                    |
                    <a href="javascript:void(0)" (click)="downloadFinalSubmit('S', 'FINAL_SUBMITTED')">Standalone</a>
                </p>
            </div>
            <div class="row col-md-12">
                <p class="ml-3" style="font-size: 17px">
                    <span style="font-weight: 500">View Pending Institution List :</span>&nbsp;&nbsp;&nbsp;<a
                        href="javascript:void(0)"
                        (click)="downloadFinalSubmit('U', 'FINAL_SUBMITTED_PENDING')">University</a>
                    |
                    <a href="javascript:void(0)"
                        (click)="downloadFinalSubmit('C', 'FINAL_SUBMITTED_PENDING')">College</a>
                    |
                    <a href="javascript:void(0)"
                        (click)="downloadFinalSubmit('S', 'FINAL_SUBMITTED_PENDING')">Standalone</a>
                </p>
            </div>
        </div>
    </div>
</div>