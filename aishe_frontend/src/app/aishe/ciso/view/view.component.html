<div class="container-fluid reg-page-bg pl-4 pr-4">
    <div class="form-group">
        <div class="form-row mr-0 ml-0">
            <div class="col-md-12 mt-0 badges p-2 mt-3">
                <div class="float-left">
                    <span class="font-weight-bold text-lg">CISO Details</span>
                </div>
            </div>
        </div>
    </div>
    <div class="animated fadeInDown card mb-2 pt-2 pb-1 bg-light overflow-hidden" *ngIf="showForm">
        <form [formGroup]="cisoForm">
            <div class="row col-md-12 overflow-hidden pt-4">
                <label style="font-weight: 500;">&nbsp;&nbsp;&nbsp;Do you want to add record with AISHE
                    Code:</label>
                <mat-radio-group aria-label="Select an option" required formControlName="priority"
                    (change)="changeFun($event.value)">
                    <mat-radio-button value="4">YES</mat-radio-button>&nbsp;&nbsp;
                    <mat-radio-button value="3">NO</mat-radio-button>
                </mat-radio-group>
            </div>
            <div class="row col-md-12 overflow-hidden">
                <div class="col-md-3" *ngIf="cisoForm.controls['priority'].value === '4'">
                    <mat-form-field class="d-block">
                        <mat-label>AISHE Code</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="agencyCode"
                            [errorStateMatcher]="errorMatcher" [required]="cisoForm.controls['priority'].value === '4'">
                    </mat-form-field>
                    <mat-hint *ngIf="inValidAishe">Please enter valid AISHE Code</mat-hint>
                    <mat-hint class="err-msgs"
                    *ngIf="cisoForm.controls['agencyCode'].dirty ||cisoForm.controls['agencyCode'].value || cisoForm.controls['agencyCode'].touched || isFormInvalid">
                    <span *ngIf="
                        cisoForm.controls['agencyCode'].hasError(
                          'required'
                        )
                      " class="errorMessage">Please enter.</span>
                </mat-hint>
                </div>
                <div class="col-md-3" *ngIf="cisoForm.controls['priority'].value === '3'">
                    <mat-form-field class="d-block">
                        <mat-label>Agency Code</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="agencyCode"
                            [errorStateMatcher]="errorMatcher" [required]="cisoForm.controls['priority'].value === '3'">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                    *ngIf="cisoForm.controls['agencyCode'].dirty ||cisoForm.controls['agencyCode'].value || cisoForm.controls['agencyCode'].touched || isFormInvalid">
                    <span *ngIf="
                        cisoForm.controls['agencyCode'].hasError(
                          'required'
                        )
                      " class="errorMessage">Please enter.</span>
                </mat-hint>
                </div>
                <div class="col-md-3 mt-3" *ngIf="cisoForm.controls['priority'].value === '4'">
                    <button type="submit" class="btn btn-info btn-sm" (click)="getDetails()"
                        matTooltip="Get Details" *ngIf="buttonName === 'Save'">Get Details</button>
                </div>
            </div>
            <div class="row col-md-12 overflow-hidden">
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Agency Name</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="agencyName" required
                            [errorStateMatcher]="errorMatcher">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['agencyName'].dirty ||cisoForm.controls['agencyName'].value || cisoForm.controls['agencyName'].touched || isFormInvalid">
                        <span *ngIf="
                            cisoForm.controls['agencyName'].hasError(
                              'required'
                            )
                          " class="errorMessage">Please enter.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Name</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="name" required
                            [errorStateMatcher]="errorMatcher">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['name'].dirty ||cisoForm.controls['name'].value || cisoForm.controls['name'].touched || isFormInvalid">
                        <span *ngIf="
                            cisoForm.controls['name'].hasError(
                              'required'
                            )
                          " class="errorMessage">Please enter.</span>
                    </mat-hint>
                </div>

                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Designation</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="designation" required
                            [errorStateMatcher]="errorMatcher">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['designation'].dirty ||cisoForm.controls['designation'].value || cisoForm.controls['designation'].touched || isFormInvalid">
                        <span *ngIf="
                            cisoForm.controls['designation'].hasError(
                              'required'
                            )
                          " class="errorMessage">Please enter.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Post</mat-label>
                        <mat-select autocomplete="off" formControlName="post" required
                            [errorStateMatcher]="errorMatcher">
                            <mat-option value="CISO">CISO</mat-option>
                            <mat-option value="Dy CISO">Deputy CISO</mat-option>
                            <mat-option value="Dy CISO 2">Deputy CISO 2</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['post'].dirty ||cisoForm.controls['post'].value || cisoForm.controls['post'].touched || isFormInvalid">
                        <span *ngIf="
                            cisoForm.controls['post'].hasError(
                              'required'
                            )
                          " class="errorMessage">Please select.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Mobile</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="mobile" required
                            [errorStateMatcher]="errorMatcher" (keypress)="onKeypressEvent($event,10)">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['mobile'].dirty ||cisoForm.controls['mobile'].value || cisoForm.controls['mobile'].touched || isFormInvalid">
                        <span *ngIf="
                                    cisoForm.controls['mobile'].hasError(
                                      'required'
                                    )
                                  " class="errorMessage">Please enter.</span>
                        <span *ngIf="
                                  cisoForm.controls['mobile'].hasError(
                                    'pattern'
                                  )
                                " class="errorMessage">Invalid.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Alternate Mobile</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="alternateMobile"
                            (keypress)="onKeypressEvent($event,10)">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['alternateMobile'].dirty ||cisoForm.controls['alternateMobile'].value || cisoForm.controls['alternateMobile'].touched || isFormInvalid">

                        <span *ngIf="
                                  cisoForm.controls['alternateMobile'].hasError(
                                    'pattern'
                                  )
                                " class="errorMessage">Invalid.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Email</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="emailId" required
                            [errorStateMatcher]="errorMatcher">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['emailId'].dirty ||cisoForm.controls['emailId'].value || cisoForm.controls['emailId'].touched || isFormInvalid">
                        <span *ngIf="
                                cisoForm.controls['emailId'].hasError(
                                  'required'
                                )
                              " class="errorMessage">Please enter.</span>
                        <span *ngIf="
                                cisoForm.controls['emailId'].hasError(
                                  'pattern'
                                )
                              " class="errorMessage">Invalid emailId.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Alternate Email</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="alternateEmail">
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['alternateEmail'].dirty ||cisoForm.controls['alternateEmail'].value || cisoForm.controls['alternateEmail'].touched || isFormInvalid">
                        <span *ngIf="
                                cisoForm.controls['alternateEmail'].hasError(
                                  'pattern'
                                )
                              " class="errorMessage">Invalid Email.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Address</mat-label>
                        <textarea matInput formControlName="officeAddress" required [errorStateMatcher]="errorMatcher"></textarea>
                        <!-- <input type="text" matInput autocomplete="off" formControlName="officeAddress" [errorStateMatcher]="errorMatcher" required> -->
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="cisoForm.controls['officeAddress'].dirty ||cisoForm.controls['officeAddress'].value || cisoForm.controls['officeAddress'].touched || isFormInvalid">
                        <span *ngIf="
                            cisoForm.controls['officeAddress'].hasError(
                              'required'
                            )
                          " class="errorMessage">Please enter.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>Remark</mat-label>
                        <textarea matInput formControlName="remarks"></textarea>
                        <!-- <input type="text" matInput autocomplete="off" formControlName="remark"> -->
                    </mat-form-field>
                </div>
            </div>
            <div class="text-center">
                <button type="submit" class="btn btn-success btn-sm" (click)="save()"  [matTooltip]="buttonName">{{buttonName}}
                </button>
                <button type="reset" class="btn btn-danger btn-sm ml-1"  matTooltip="Reset" (click)="reset()">Reset
                </button>
               
                  <button class="btn btn-warning btn-sm ml-1" matTooltip="Close" (click)="close()">Close</button>
            </div>
        </form>
    </div>

    <div class="animated fadeInDown card bg-light">
        <div class="row col-md-12 overflow-hidden">
            <div class="col-md-2 pt-4">
                <label>Show</label>&nbsp;
                <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
                    <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
                </select>
                entries
            </div>
            <div class="col-md-4"></div>
            <div class="col-md-4 pt-4">
                <label>Search:</label>&nbsp;
                <input type="text" size="30" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
                    [(ngModel)]="searchText">
            </div>
            
            <div class="col-md-2 pt-4">
                <button mat-raised-button color="primary" (click)="addCiso()" matTooltip="Add New CISO">Add New
                    CISO</button>
            </div>
        </div>
        <div class="row col-md-12 overflow-hidden">
            <div class="col-md-4">
                <mat-form-field class="d-block">
                    <mat-label>Agency Name</mat-label>
                    <mat-select (selectionChange)="getAgencyByName()" [(ngModel)]="agencyName">
                        <mat-select-filter [array]="agencyListArray" [displayMember]="'agencyName'"
                        (filteredReturn)="agencyList = $event">
                      </mat-select-filter>
                        <mat-option *ngFor="let item of agencyList"
                            [value]="item.agencyName">{{item.agencyName}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>Post</mat-label>
                    <mat-select (selectionChange)="getAgencyByPost()" [(ngModel)]="post">
                        <mat-option value="--ALL--">--ALL--</mat-option>
                        <mat-option value="CISO">CISO</mat-option>
                        <mat-option value="Dy CISO">Deputy CISO</mat-option>
                        <mat-option value="Dy CISO 2">Deputy CISO 2</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="d-block">
                    <mat-label>Institution Type</mat-label>
                    <mat-select (selectionChange)="getAgencyNameByType($event.value)" [(ngModel)]="agencyType">
                        <mat-option value="--ALL--">--ALL--</mat-option>
                        <mat-option *ngFor="let item of sharedService.institutionList"
                            [value]="item.id">{{item.name}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-1">
                <button class="btn btn-sm btn-dark d-block mt-3" (click)="reload()" matTooltip="Refresh">
                  <i class="fa fa-refresh" aria-hidden="true"></i>
                </button>
              </div> 
              <div class="col-md-2 pt-4">
                <label class="download" matTooltip="Download as PDF" (click)="download()">Download:-
                  <i class="fa fa-file-pdf-o downloadPDF"></i></label>
              </div>
        </div>

    </div>

    <div class="animated fadeInDown card mb-2 pb-1 pt-1 bg-light overflow-hidden">
        <div class="col-md-12 table-responsive">
            <table class="table table-bordered table-sm">
                <tr>
                    <th>S.No.</th>
                    <th>Agency Code</th>
                    <th>Agency Name</th>
                    <th>Name</th>
                    <th>Mobile</th>
                    <th>Email</th>
                    <th>Post</th>
                    <th>Designation</th>
                    <th>Address</th>
                    <th>Action</th>
                </tr>
                <ng-container *ngFor="let item of listData| paginate : {
                    itemsPerPage: pageSize,
                    currentPage: page
                  
                  };
            let i = index">
                    <tr>
                        <td>{{i+StartLimit+1}}</td>
                        <td>{{item.agencyCode}}</td>
                        <td>{{item.agencyName}}</td>
                        <td>{{item.name}}</td>
                        <td>{{item.mobile}}</td>
                        <td>{{item.emailId}}</td>
                        <td>{{item.post}}</td>
                        <td>{{item.designation}}</td>
                        <td>{{item.officeAddress}}</td>

                        <td style="width:100px"><mat-icon class="view_icon" matTooltip="View"
                                (click)="openDialog(item,i)">remove_red_eye</mat-icon>
                            <mat-icon class="edit_icon" matTooltip="Edit"
                                (click)="edit(item,i)">edit</mat-icon>
                            <mat-icon class="delete_icon" matTooltip="Delete"
                                (click)="delete(item)">delete_forever</mat-icon>
                        </td>
                    </tr>
                </ng-container>
            </table>
        </div>
        <div class="row col-md-12 overflow-hidden">
            <div class="col-md-3">
                Showing {{StartLimit + 1}} to {{pageData === -1?0:pageData}} Of {{listData.length}}
                entries
            </div>
            <div class="col-md-3"></div>
            <div class="col-md-6" *ngIf="listData.length !== 0">
                <pagination-controls previousLabel="Prev" nextLabel="Next" (pageChange)="handlePageChange($event)"
                    screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
                    screenReaderCurrentLabel="You're on page"></pagination-controls>
            </div>
        </div>
    </div>
</div>