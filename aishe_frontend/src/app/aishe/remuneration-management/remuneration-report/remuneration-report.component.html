<div class="animated fadeInDown card shadow mb-4 pt-1 pb-2 pr-4 pl-4 bg-light">
    <form [formGroup]="userFormData">
        <div class="row col-md-12 overflow-hidden pt-2">
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>Survey Year</mat-label>
                    <mat-select
                        formControlName="surveyYear"
                        placeholder="Select Survey Year"
                    >
                        <mat-option value="2020">2020-21</mat-option>
                        <mat-option value="2021">2021-22</mat-option>
                        <mat-option value="2022">2022-23</mat-option>
                    </mat-select>
                    <mat-error *ngIf="userFormData.controls['surveyYear'].hasError('required')">Survey Year is required</mat-error>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>AISHE Code</mat-label>
                    <input
                        formControlName="aisheCode"
                        placeholder="e.g. C/S/U-1235"
                        matInput
                        type="text"
                    >
                </mat-form-field>

            </div>
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>State</mat-label>
                    <mat-select
                        (selectionChange)="getDistrict($event.value)"
                        formControlName="stateCode"
                    >
                        <mat-select-filter
                            [array]="variables"
                            [displayMember]="'name'"
                            (filteredReturn)="stateList = $event"
                        >
                        </mat-select-filter>
                        <mat-option
                            [value]="state.stateCode"
                            *ngFor="let state of stateList"
                        >
                            {{state.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>District</mat-label>
                    <mat-select formControlName="district">
                        <mat-select-filter
                            [array]="variables1"
                            [displayMember]="'name'"
                            (filteredReturn)="districtList = $event"
                        ></mat-select-filter>
                        <mat-option
                            *ngFor="let data of districtList"
                            [value]="data.distCode"
                        >
                            {{data.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="d-block">
                    <mat-label>Institution Type</mat-label>
                    <mat-select
                        formControlName="instituteType"
                        placeholder="Institution Type"
                        (selectionChange)="getInstituteSubType($event.value)"
                    >
                        <mat-option value="ALL">All</mat-option>
                        <mat-option value="C">COLLEGE</mat-option>
                        <mat-option value="S">STAND ALONE</mat-option>
                        <mat-option value="U">UNIVERSITY</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="d-block">
                    <mat-label>
                        {{userFormData.controls['instituteType'].value  === 'C'?"University Type":"Institution Sub Type"}}
                    </mat-label>
                    <mat-select
                        (selectionChange)="userFormData.controls['instituteType'].value  === 'C'?getUniversityByType($event.value):''"
                        formControlName="instituteSubType"
                    >
                        <mat-select-filter
                            [array]="instituteType1"
                            [displayMember]="'type'"
                            (filteredReturn)="institutionTypeList = $event"
                        >
                        </mat-select-filter>
                        <mat-option
                            *ngFor="let data of institutionTypeList"
                            [value]="data.id"
                        >
                            {{data.type}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div
                class="col-md-3"
                *ngIf="userFormData.controls['instituteSubType'].value && userFormData.controls['instituteType'].value  === 'C'"
            >
                <mat-form-field class="d-block">
                    <mat-label>University</mat-label>
                    <mat-select
                        placeholder="Select University"
                        formControlName="universityType"
                    >
                        <mat-select-filter
                            [array]="universityListArray"
                            [displayMember]="'name'"
                            (filteredReturn)="universityList = $event"
                        >
                        </mat-select-filter>
                        <mat-option
                            *ngFor="let data of universityList"
                            [value]="data.id"
                        >
                            {{data.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>From Date</mat-label>
                    <input
                        formControlName="fromDate"
                        matInput
                        type="date"
                    >
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>To Date</mat-label>
                    <input
                        formControlName="toDate"
                        matInput
                        type="date"
                    >
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field>
                    <mat-label>Status</mat-label>
                    <mat-select
                        placeholder="Status"
                        formControlName="status"
                    >

                        <mat-option
                            *ngFor="let item of sharedService.remuneration"
                            [value]=item.id
                        >
                            {{item.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="row d-block text-center form-group p-2 m-2">
                <button
                    class="btn btn-success m-1"
                    (click)="findData()"
                >
                    Find
                </button>
                <button
                    class="btn btn-danger"
                    (click)="clrae()"
                >
                    Clear
                </button>
            </div>
        </div>

    </form>
</div>
<section class="p-3">
    <div class="container-fluid">
        <div class="animated fadeInDown card mb-2 pt-2 pb-1 bg-light overflow-hidden">
            <div class="row col-md-12 overflow-hidden">
                <div class="col-md-2 pt-4">
                    <label>Show</label>
                    &nbsp;
                    <select
                        [(ngModel)]="pageSize"
                        (ngModelChange)="onChange($event)"
                    >
                        <option
                            *ngFor="let data of sharedService.pageSizeOptions"
                            [value]="data"
                        >
                            {{data}}
                        </option>
                    </select>
                    entries
                </div>
                <div class="col-md-4"></div>
                <div class="col-md-5 pt-4">
                    <label>Search:</label>
                    &nbsp;
                    <input
                        type="text"
                        size="40"
                        id='myInput'
                        (change)="updateResults()"
                        (keyup)="updateResults()"
                        [(ngModel)]="searchText"
                    >
                </div>
                <div class="col-md-1 mt-2">
                    <a
                        mat-button
                        (click)="dataList.length?downloadExcel():''"
                    >
                        <i
                            class="fa fa-file-excel-o"
                            matTooltip="Download as Excel"
                            matTooltipPosition="above"
                            matTooltipClass="blackTooltip"
                            style="font-size: 24px;"
                        ></i>
                        <mat-icon style="color: green;">vertical_align_bottom</mat-icon>
                    </a>
                </div>
            </div>
            <div class="row col-md-12 overflow-hidden">
                <div class="col-md-12 table-responsive">
                    <table class="table table-bordered table-sm">
                        <thead>
                            <tr rowspan="2">
                                <th rowspan="2">
                                    <mat-checkbox
                                        type="checkbox"
                                        [checked]="checkedR"
                                        (change)="checkeRem($event)"
                                        class="example-margin"
                                        [(ngModel)]="checkedR"
                                    ></mat-checkbox>
                                </th>
                                <th rowspan="2">S.No</th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'surveyYear')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Survey Year
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'stateName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    State
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'districtName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    District
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'aisheCode')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    AISHE&nbsp;Code
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'institutionName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Institution Name
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'type')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Institution Sub Type / Affilated University Name
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'nodalOfficerName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Nodal Officer Name
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'bankName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Bank Name
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'ifscCode')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Bank IFSC
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'accountNumber')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Account Number
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'accountHolderName')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    Account Holder Name
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'pan')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                    PAN Number
                                </th>
                                <th colspan="3">
                                    No of Colleges (Applicable for University)
                                </th>
                                <th rowspan="2">
                                    <i
                                        (click)="onSortClick($event,'amount')"
                                        class="fa fa-chevron-up"
                                        style="color: white;"
                                    ></i>
                                  Max Amount
                                </th>
                                <th rowspan="2">Participated in First Time(Applicable for University)</th>
                                <th rowspan="2">
                                    Remuneration Amount 
                                </th>

                                <th rowspan="2">Status</th>
                                <th rowspan="2">Submitted On</th>
                            </tr>

                            <tr>
                                <th>Total Affiliated</th>
                                <th>Final Submitted</th>
                                <th>Percentage</th>
                            </tr>
                            </thead>
                            <tbody>
                            <ng-container *ngFor="let item of dataList | paginate : {
                            itemsPerPage: pageSize,
                            currentPage: page
                          
                          };
                    let i = index
                    ">
                                <!-- <tr [ngClass]="item.statusId===1?'black-checkbox':''"></tr> -->
                                <tr [ngClass]="item.statusId===1?'black-checkbox':''">
                                    <td>
                                        <mat-checkbox
                                            class="example-margin"
                                            [(ngModel)]="item.checked"
                                            [disabled]="item.statusId===1"
                                        >
                                            <!-- [disabled]="item.statusId===1" -->
                                        </mat-checkbox>
                                    </td>
                                    <td>{{i+StartLimit+1}}</td>
                                    <td>{{item.surveyYear}}</td>
                                    <td>{{item.stateName}}</td>
                                    <td>{{item.districtName}}</td>
                                    <td>{{item.aisheCode}}</td>

                                    <td>{{item.institutionName}}</td>
                                    <td>{{item.type}}</td>
                                    <td>{{item.nodalOfficerName}}</td>
                                    <td>{{item.bankName}}</td>
                                    <td>{{item.ifscCode}}</td>
                                    <td>{{item.accountNumber}}</td>
                                    <td>{{item.accountHolderName}}</td>
                                    <td>{{item.pan}}</td>
                                    <td>{{item.numberOfAffiliatingCollege}}</td>
                                    <td>{{item.numberOfDcfSubmittedCollege}}</td>
                                    <td>{{item?.percentage?item?.percentage.toFixed(2):''}}</td>
                                    <td>{{item.amount}}</td>
                                    <td>{{item.isThisNewUniversity===null?'NA':item.isThisNewUniversity===true?'Yes':'No'}}</td>
                                    <td>{{item.RemunerationAmountUniversity?item.RemunerationAmountUniversity.toFixed(2):''}}</td>
                                    <td>{{item?.statusName}}</td>
                                    <td>{{item.submittedOn}}</td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row col-md-12 overflow-hidden">
                <div class="col-md-3">
                    Showing {{StartLimit + 1}} to {{pageData === -1?0:pageData}} Of {{dataList.length}}
                    entries
                </div>
                <div class="col-md-3"></div>
                <div class="col-md-6">
                    <pagination-controls
                        previousLabel="Prev"
                        nextLabel="Next"
                        (pageChange)="handlePageChange($event)"
                        screenReaderPaginationLabel="Pagination"
                        screenReaderPageLabel="page"
                        screenReaderCurrentLabel="You're on page"
                    ></pagination-controls>
                </div>
            </div>
        </div>
    </div>

</section>
<div
    class="col-md-12"
    *ngIf="!showTable&&dataList?.length ===0"
>
    <p style="color: red;">No Record Found</p>
</div>

<div
    *ngIf="dataList?.length"
    class="row"
    style="
justify-content: center;"
>
    <div>
        <button
            class="btn btn-primary"
            (click)="dataList.length?openStatusPup():''"
        >
            UPDATE REMUNERATION STATUS
        </button>
    </div>
</div>
