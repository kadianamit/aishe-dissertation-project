<div class="container-fluid reg-page-bg pl-4 pr-4">
    <div class="form-group">
        <div class="form-row mr-0 ml-0">
            <div class="col-md-12 mt-0 badges p-2 mt-3">
                <div class="float-left">
                    <span class="font-weight-bold text-lg">Enrolment Estimation</span>
                </div>
                <div
                    class="float-right ml-2"
                    *ngIf="listData && listData.length"
                >
                    <button
                        mat-stroked-button
                        color="warn"
                        (click)="downloadReort()"
                        matTooltip="Please click here to download report"
                    >
                        <mat-icon>vertical_align_bottom</mat-icon>
                        Generate Report
                    </button>
                </div>
                <div
                    class="float-right"
                    *ngIf="sharedService.role['Ministry of Education'] === roleId || this.sharedService.role['SysAdmin'] === roleId"
                >
                    <button
                        mat-flat-button
                        color="primary"
                        (click)="addRecord(true)"
                        *ngIf="!showField"
                    >
                        Add
                    </button>
                </div>

            </div>
        </div>
    </div>
    <div
        class="animated fadeInDown card mb-2 pt-2 pb-1 bg-light overflow-hidden"
        *ngIf="showField"
    >
        <div class="col-md-2 pt-4">
            <mat-form-field class="d-block">
                <mat-label>State</mat-label>
                <mat-select
                    [(ngModel)]="stateCode"
                    (selectionChange)="getDistrictData($event.value)"
                    [disabled]="editButton"
                >
                    <mat-select-filter
                        [array]="stateListArray"
                        [displayMember]="'name'"
                        (filteredReturn)="stateList = $event"
                    >
                    </mat-select-filter>
                    <mat-option
                        *ngFor="let data of stateList"
                        [value]="data.stateCode"
                    >
                        {{data.name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="col-md-12 table-responsive">
            <table class="table table-bordered table-sm">
                <tbody>
                    <tr>
                        <th rowspan="2">S.No.</th>
                        <th rowspan="2">
                            <!-- <input
                                type="checkbox"
                                [(ngModel)]="checked1"
                                (change)="checkbox($event)"
                            > -->
                            Select
                        </th>
                        <th rowspan="2">District Name</th>
                        <th
                            colspan="3"
                            class="text-center"
                        >
                            PG
                        </th>
                        <th
                            colspan="3"
                            class="text-center"
                        >
                            UG
                        </th>
                    </tr>
                    <tr>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Total</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Total</th>
                    </tr>

                    <ng-container *ngFor="let opt of districtList;let i=index">
                        <tr>
                            <td>{{i+1}}</td>
                            <td>
                                <input
                                    type="checkbox"
                                    [(ngModel)]="opt.checked"
                                >
                            </td>
                            <td>{{opt.district}}</td>
                            <td>{{opt.pgMale}}</td>
                            <td>{{opt.pgFemale}}</td>
                            <td>{{opt.pgTotal}}</td>
                            <td>{{opt.ugMale}}</td>
                            <td>{{opt.ugFemale}}</td>
                            <td>{{opt.ugTotal}}</td>
                        </tr>
                    </ng-container>
                </tbody>
            </table>
        </div>
        <div class="form-group mt-3 text-center">
            <button
                class="btn btn-success btn-sm mr-2"
                type="submit"
                (click)="save()"
                *ngIf="districtList && districtList.length"
            >
                {{editButton?'Update':'Save'}}
            </button>
            <button
                class="btn btn-danger btn-sm mr-2"
                (click)="addRecord(false)"
            >
                Close
            </button>

        </div>
    </div>

    <hr>
    <div class="animated fadeInDown card mb-2 pt-6 pb-1 bg-light overflow-hidden">
        <div class="col-md-12 table-responsive">
            <table class="table table-bordered table-sm">
                <tbody>
                    <tr>
                        <th>S.No.</th>
                        <th>State</th>
                        <th>District</th>
                        <th *ngIf="sharedService.role['Ministry of Education'] === roleId || this.sharedService.role['SysAdmin'] === roleId">Action</th>
                    </tr>
                    <ng-container *ngFor="let opt of listData;let i=index">
                        <tr>
                            <td>{{i+1}}</td>
                            <td>{{opt.state?.name}}</td>
                            <td>
                                <span *ngFor="let e of opt.districts;let i=index">
                                    {{e.name}}{{i === opt.districts.length - 1
                                ? '' : ', '}}
                                </span>
                            </td>
                            <td *ngIf="sharedService.role['Ministry of Education'] === roleId || this.sharedService.role['SysAdmin'] === roleId">
                                <mat-icon
                                    class="edit_icon"
                                    matTooltip="Edit"
                                    (click)="edit(opt.state?.stateCode,opt.id)"
                                >
                                    edit
                                </mat-icon>
                            </td>
                        </tr>
                    </ng-container>
                </tbody>
            </table>
        </div>
    </div>
</div>
