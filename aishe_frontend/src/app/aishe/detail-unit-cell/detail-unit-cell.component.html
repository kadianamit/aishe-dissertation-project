<div class="container-fluid reg-page-bg pl-4 pr-4">
    <div class="form-group">
        <div class="form-row mr-0 ml-0">
            <div class="col-12 mt-3 badges p-2">
                <div class="float-left">
                    <span class="font-weight-bold text-lg">Details of AISHE Unit Cell</span>
                </div>
            </div>
        </div>
    </div>
    <div class="animated fadeInDown card mb-2 pt-2 pb-1 bg-light overflow-hidden" *ngIf="sharedService.role['State Nodal Officer'] === roleId">
        <form [formGroup]="unitCellForm" (ngSubmit)="submit()">
            <div class="row col-md-12 overflow-hidden pt-4">
                <div class="col-md-6">
                    <mat-form-field class="d-block">
                        <mat-label>State</mat-label>
                        <mat-select formControlName="state" required [errorStateMatcher]="errorMatcher">
                           <mat-option *ngFor="let e of stateList" [value]="e.stateCode">{{e.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-hint class="err-msgs"
                        *ngIf="unitCellForm.controls['state'].dirty ||unitCellForm.controls['state'].value || unitCellForm.controls['state'].touched || isFormInvalid">
                        <span *ngIf="
                    unitCellForm.controls['state'].hasError(
                      'required'
                    )
                  " class="errorMessage">Please select.</span>
                    </mat-hint>
                </div>
                <div class="col-md-6 my-auto">
                  
                        <mat-label style="font-weight: 500;">Whether your State is having AISHE Unit Cell</mat-label>
                        <mat-radio-group formControlName="unitCell" (change)="isUnitCell()"
                        >
                        &nbsp;
                        <mat-radio-button [value]=true>Yes</mat-radio-button>
                        &nbsp;
                        <mat-radio-button [value]=false >No</mat-radio-button>
                    </mat-radio-group>
               
                    <mat-hint class="err-msgs"
                        *ngIf="unitCellForm.controls['unitCell'].dirty ||unitCellForm.controls['unitCell'].value || unitCellForm.controls['unitCell'].touched || isFormInvalid">
                        <span *ngIf="
                        unitCellForm.controls['unitCell'].hasError(
                          'required'
                        )
                      " class="errorMessage">Please enter.</span>
                    </mat-hint>
                </div>
            </div>
            <hr *ngIf="showUnitCellDetail">

            <div class="row col-md-12" *ngIf="showUnitCellDetail"><h3 class="font-weight-bold text-lg ml-1" style="padding-left: 10px;">Add Officer Detail of Unit Cell</h3></div>
            <div class="row col-md-12 overflow-hidden pt-4"
            formArrayName="details" *ngIf="showUnitCellDetail">
               <div class="row col-md-12 mr-0 pr-0" *ngFor="let group of details.controls; let i = index;let first = first; let last = last" [formGroupName]="i" style="width: 100%!important;">
                <div class="col-md-1 my-auto text-center"><h4 class="my-auto">{{ i + 1 }}.</h4></div>
                <div class="col-md-3">
                    <mat-form-field class="d-block">
                        <mat-label>Officer Name</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="officialDetail"
                            (keypress)="onKeypressEvent($event,200)" required [errorStateMatcher]="errorMatcher">
                            <mat-error *ngIf="group.get('officialDetail')?.hasError('required')">
                                Officer Name is required.
                              </mat-error>
                              <mat-error *ngIf="group.get('officialDetail')?.hasError('pattern')">
                                Only characters, dot(.) and white space are allowed.
                              </mat-error>  
                    </mat-form-field>
                </div>
                <div class="col-md-2">
                    <mat-form-field class="d-block">
                        <mat-label>Designation</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="designation"
                            (keypress)="onKeypressEvent($event,200)" required [errorStateMatcher]="errorMatcher">
                            <mat-error *ngIf="group.get('designation')?.hasError('required') || isFormInvalid">
                                Designation is required.
                              </mat-error>
                              <mat-error *ngIf="group.get('designation')?.hasError('pattern')">
                                Only characters and white space are allowed.
                              </mat-error>    
                    </mat-form-field>
                </div>
                <div class="col-md-2">
                    <mat-form-field class="d-block">
                        <mat-label>Current Annual Salary(Rs. absolute)</mat-label>
                        <input type="text" matInput autocomplete="off" formControlName="currentSalary" maxlength="8"
                            (keypress)="onKeypressEvent($event,200)" required [errorStateMatcher]="errorMatcher">
                            <mat-error *ngIf="group.get('currentSalary')?.hasError('required')">
                                Current Salary is required.
                              </mat-error>
                              <mat-error *ngIf="group.get('currentSalary')?.hasError('pattern')">
                                Only Numerical is allowed.
                              </mat-error>
                    </mat-form-field>
                    
                </div>
                <div class="col-md-3">
                    <mat-form-field class="d-block">
                        <mat-label>Mode Of Engagement</mat-label>
                        <mat-select formControlName="mode" required [errorStateMatcher]="errorMatcher">
                           <mat-option *ngFor="let e of modeList" [value]="e.value">{{e.type}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="group.get('mode')?.hasError('required')">
                            Mode Of Engagement is required.
                          </mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-1 mt-4 mb-0 pb-0 my-auto">
                    <mat-icon type="button" class="delete_icon" matTooltip="Delete" (click)="deleteUnitCell(i)"
                    >remove_circle</mat-icon>
         
                    <mat-icon type="button" *ngIf="last" class="blue-icon" matTooltip="Add" (click)="addUnitDetails()"
                   >add_circle</mat-icon>
        
                </div>
               </div>
            </div>
            <div class="text-center" >
                <button type="submit" class="btn btn-success btn-sm" 
                    >Submit
                </button>
                <button type="button" class="btn btn-danger btn-sm ml-1" matTooltip="Reset" (click)="reset()">Reset
                </button>
    
                <!-- <button class="btn btn-warning btn-sm ml-1" matTooltip="Close" (click)="close()">Close</button> -->
            </div>
      
        </form>
    </div>
    <div class="row">
        <div class="col-md-12 mt-1">

            <a mat-button (click)="downloadExcel()" style="float: right;">
                <i class="fa fa-file-excel-o" matTooltip="Download as Excel" matTooltipPosition="above"
                    matTooltipClass="downloadExcel" style="font-size: 24px;color: green;"></i>
                <mat-icon style="color: green;">vertical_align_bottom</mat-icon>
            </a>
        </div>
    </div>

  


       <!-- Document Table Section -->
    <div class="animated fadeInDown card mb-2 pb-1 pt-1 bg-light overflow-hidden" *ngIf="(sharedService.role['Ministry of Education'] === roleId || sharedService.role['SysAdmin'] === roleId)">
        <div class="col-12 table-responsive">
            <table class="table table-bordered table-sm" >
                <tr class="text-center">
                    <th colspan="3"></th>
                    <th colspan="3" class="text-center">Mode of Engagement</th>
                    <th colspan="3">Current Annual Salary(Rs.)</th>
                </tr>
                <tr class="text-center">
                    <th>S.No.</th>
                    <th>State</th>
                    <th>AISHE Unit Cell</th>
                    <th>Permanent</th>
                    <th>Contractual</th>
                    <th>Total</th>
                    <th>Permanent</th>
                    <th>Contractual</th>
                    <th>Total</th>
                </tr>


                <ng-container *ngFor="let item of moeUnitCellList | paginate : { itemsPerPage: pageSize, currentPage: page }; let i = index">
                    <tr >
                        <td class="text-center">{{i+StartLimit+1}}</td>
                        <td class="text-center" ><a href="javascript:void(0)" (click)="getStateDetail(item)">{{item?.state|titlecase}}</a></td>
                        <td class="text-center">{{item?.unitCell==false?'No':'Yes'}}</td>
                        <td class="text-center">{{item?.permanent}}</td>
                        <td class="text-center">{{item?.contractual}}</td>
                        <td class="text-center">{{(item?.permanent+item?.contractual)}}</td>
                        <td class="text-center">{{item?.psalary}}</td>
                        <td class="text-center">{{item?.csalary}}</td>
                        <td class="text-center">{{item?.totalSalary}}</td>
                    </tr>
                </ng-container>
            </table>
        </div>
        <div class="row col-12 overflow-hidden">
            <div class="col-12 col-md-3">
                Showing {{StartLimit + 1}} to {{pageData2 === -1?0:pageData2}} Of {{moeUnitCellList?.length}} entries
            </div>
            <div class="col-md-3"></div>
            <div class="col-12 col-md-6" *ngIf="moeUnitCellList?.length !== 0">
                <pagination-controls previousLabel="Prev" nextLabel="Next" (pageChange)="handlePageChange2($event)"
                    screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
                    screenReaderCurrentLabel="You're on page"></pagination-controls>
            </div>
        </div>
    </div>


        <!-- Document Table Section -->
        <div class="animated fadeInDown card mb-2 pb-1 pt-1 bg-light overflow-hidden" *ngIf="sharedService.role['State Nodal Officer'] === roleId || showStatewiseData">
            <div class="col-12 table-responsive">
                <table class="table table-bordered table-sm">
                    <tr>
                        <th>S.No.</th>
                        <th *ngIf="sharedService.role['State Nodal Officer'] !== roleId">State</th>
                        <th>AISHE Unit Cell</th>
                        <th>Officer Name</th>
                        <th>Designation</th>
                        <th>Current Annual Salary(Rs.)</th>
                        <th>Mode of Engagement</th>

                        <th *ngIf="sharedService.role['State Nodal Officer'] === roleId">Action</th>
                    </tr>
                    <ng-container *ngFor="let item of listData2 | paginate : { itemsPerPage: pageSize, currentPage: page }; let i = index">
                        <tr>
                            <td>{{i+StartLimit+1}}</td>
                            <td *ngIf="sharedService.role['State Nodal Officer'] !== roleId">{{item?.refState?.name}}</td>
                            <td>{{item.whetherStateHavingAisheUnitCell==false?'No':'Yes'}}</td>
                            <td>{{item?.officerName?(item?.officerName|titlecase):'-'}}</td>
                            <td>{{item?.designation?(item?.designation|titlecase):'-'}}</td>
                            <td>{{item?.currentSalary?item?.currentSalary:'-'}}</td>
                            <td>{{item?.modeOfEngagement === 'C'?'Contractual':(item?.modeOfEngagement==null?'-':'Permanent')}}</td>



                            <td style="width: 100px;" *ngIf="sharedService.role['State Nodal Officer'] === roleId && item.whetherStateHavingAisheUnitCell!=false">
                                <mat-icon  class="edit_icon" matTooltip="Edit" (click)="clearFormArray(details);addUnitDetails(item);" *ngIf="stateCode !== '21'">edit</mat-icon>
                                <mat-icon class="delete_icon" matTooltip="Delete" (click)="delete(item)" >delete_forever</mat-icon>
                            </td>
                        </tr>
                    </ng-container>
                </table>
            </div>
            <div class="row col-12 overflow-hidden">
                <div class="col-12 col-md-3">
                    Showing {{StartLimit + 1}} to {{pageData === -1?0:pageData}} Of {{listData2?.length}} entries
                </div>
                <div class="col-md-3"></div>
                <div class="col-12 col-md-6" *ngIf="listData2?.length !== 0">
                    <pagination-controls previousLabel="Prev" nextLabel="Next" (pageChange)="handlePageChange($event)"
                        screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
                        screenReaderCurrentLabel="You're on page"></pagination-controls>
                </div>
            </div>
        </div>
  </div>
  