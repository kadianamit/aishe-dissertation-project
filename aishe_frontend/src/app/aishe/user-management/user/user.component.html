<div class="container-fluid reg-page-bg pl-4 pr-4">
  <div class="form-group">
    <div class="form-row mr-0 ml-0">
      <div class="col-md-12 mt-0 badges p-2 mt-3">
        <div class="float-left">
          <span class="font-weight-bold text-lg">User Management</span>
        </div>
      </div>
    </div>
  </div>

  <mat-tab-group animationDuration="0ms" class="exam-tabing-steps" [(selectedIndex)]="selectedIndex"
    (selectedTabChange)="tabSelected($event)">

    <mat-tab label="Level 1">
      <div class="animated fadeInDown card bg-light"
        *ngIf="roleId === sharedService.role['SysAdmin'] || roleId === sharedService.role['Ministry of Education'] || roleId === sharedService.role['Apex User']">
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2 pt-4">
            <label>Show</label>&nbsp;
            <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
              <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
            </select>
            entries
          </div>
          <div class="col-md-5"></div>
          <div class="col-md-5 pt-4">
            <label>Search:</label>&nbsp;
            <input type="text" size="40" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
              [(ngModel)]="searchText">
          </div>
        </div>
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-3">
            <mat-form-field class="d-block">
              <mat-label>Select Officers</mat-label>
              <mat-select placeholder="Select Officers" [(ngModel)]="officers">
                <mat-option *ngFor="let item of subRoleLevel1" [value]="item.id">{{item.roleName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <mat-form-field class="d-block">
              <mat-label>Registration Status</mat-label>
              <mat-select placeholder="Select Registration Status" [(ngModel)]="userStatus">
                <mat-option *ngFor="let item of statuslist" [value]="item.id">{{item.status}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
              (click)="selfUserDetail('find')">
              <i class="fa fa-search" aria-hidden="true"></i></button>

              <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
              (click)="reset('level1')">
              <i class="fa fa-refresh" aria-hidden="true"></i></button>
          </div>
          
          <!-- <div class="col-md-1">
              <button mat-button class="btn btn-sm btn-danger d-block mt-3" matTooltip="Refresh" (click)="reload()">
                <i class="fa fa-refresh" aria-hidden="true"></i>
              </button>
            </div> -->
        </div>

      </div>
      <mat-card class="m-1 mt-3" *ngIf="selfDetailsLevel1">
        <h1 class="authorized">You are not authorized for this Tab</h1>
      </mat-card>
    </mat-tab>

    <mat-tab label="Level 2">
      <div class="animated fadeInDown card bg-light">
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2 pt-4">
            <label>Show</label>&nbsp;
            <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
              <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
            </select>
            entries
          </div>
          <div class="col-md-5"></div>
          <div class="col-md-5 pt-4">
            <label>Search:</label>&nbsp;
            <input type="text" size="40" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
              [(ngModel)]="searchText">
          </div>
        </div>
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2" *ngIf="!selfDetailsLevel2">
            <mat-form-field class="d-block">
              <mat-label>Select Officers</mat-label>
              <mat-select placeholder="Select Officers" [(ngModel)]="officers"
                (selectionChange)="getUniversityList(officers,$event.value)">
                <mat-option *ngFor="let item of subRoleLevel2" [value]="item.id">{{item.roleName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="!selfDetailsLevel2">
            <mat-form-field class="d-block">
              <mat-label>Registration Status</mat-label>
              <mat-select placeholder="Select Registration Status" [(ngModel)]="userStatus">
                <mat-option *ngFor="let item of statuslist" [value]="item.id">{{item.status}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="isState">
            <mat-form-field class="d-block">
              <mat-label>State</mat-label>
              <mat-select placeholder="--Select State--" [(ngModel)]="stateCode"
                (selectionChange)="getUniversityList(officers,$event.value)">
                <mat-select-filter [array]="stateListArray" [displayMember]="'name'"
                  (filteredReturn)="stateList = $event">
                </mat-select-filter>
                <mat-option *ngFor="let data of stateList" [value]="data.stateCode">{{data.name}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="isUniversity">
            <mat-form-field class="d-block">
              <mat-label>University</mat-label>
              <mat-select placeholder="--Select University--" [(ngModel)]="universityId">
                <mat-select-filter [array]="universityListArray" [displayMember]="'universityName'"
                  (filteredReturn)="universityList = $event">
                </mat-select-filter>
                <mat-option [value]="null">All</mat-option>
                <mat-option *ngFor="let data of universityList"
                  [value]="data.aisheId">{{data.universityName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="col-md-1" *ngIf="!selfDetailsLevel2">
            <mat-form-field class="d-block">
              <mat-label>From Date:</mat-label>
              <input matInput [matDatepicker]="picker1" readonly [max]="maxDate" [(ngModel)]="fromDate"
                placeholder="From Date" (dateChange)="handleToDate($event)">
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker-toggle matSuffix (click)="clearEndDate()">
                <mat-icon matDatepickerToggleIcon>clear</mat-icon>
            </mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-1" *ngIf="!selfDetailsLevel2">
            <mat-form-field class="d-block">
              <mat-label>To Date:</mat-label>
              <input matInput [matDatepicker]="picker2" readonly [min]="minDate" [max]="maxDate" [(ngModel)]="toDate"
                placeholder="To Date">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker-toggle matSuffix (click)="clearStartDate()">
                <mat-icon matDatepickerToggleIcon>clear</mat-icon>
            </mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>


          <div class="col-md-2" *ngIf="!selfDetailsLevel2">
            <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
              (click)="selfUserDetail('find')">
              <i class="fa fa-search" aria-hidden="true"></i></button>
              <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
              (click)="reset('level2')">
              <i class="fa fa-refresh" aria-hidden="true"></i></button>
          </div>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Level 3">
      <div class="animated fadeInDown card bg-light">
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2 pt-4">
            <label>Show</label>&nbsp;
            <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
              <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
            </select>
            entries
          </div>
          <div class="col-md-5"></div>
          <div class="col-md-5 pt-4">
            <label>Search:</label>&nbsp;
            <input type="text" size="40" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
              [(ngModel)]="searchText">
          </div>
        </div>


        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2" *ngIf="!selfDetailsLevel3">
            <mat-form-field class="d-block">
              <mat-label>Select Body</mat-label>
              <mat-select placeholder="Select Officers" [(ngModel)]="officers"
                (selectionChange)="getUniversityList(officers,$event.value)">
                <mat-option *ngFor="let item of subRoleLevel3" [value]="item.id">{{item.roleName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="isState">
            <mat-form-field class="d-block">
              <mat-label>State</mat-label>
              <mat-select placeholder="--Select State--" [(ngModel)]="stateCode"
                (selectionChange)="getUniversityList(officers,$event.value)">
                <mat-select-filter [array]="stateListArray" [displayMember]="'name'"
                  (filteredReturn)="stateList = $event">
                </mat-select-filter>
                <mat-option [value]="0" *ngIf="roleId === sharedService.role['University']">ALL</mat-option>
                <mat-option *ngFor="let data of stateList" [value]="data.stateCode">{{data.name}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="col-md-2" *ngIf="!selfDetailsLevel3">
            <mat-form-field class="d-block">
              <mat-label>Registration Status</mat-label>
              <mat-select placeholder="Select Registration Status" [(ngModel)]="userStatus">
                <mat-option *ngFor="let item of statuslist" [value]="item.id">{{item.status}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="isUniversity">
            <mat-form-field class="d-block">
              <mat-label>University</mat-label>
              <mat-select placeholder="--Select University--" [(ngModel)]="universityId">
                <mat-select-filter [array]="universityListArray" [displayMember]="'universityName'"
                  (filteredReturn)="universityList = $event">
                </mat-select-filter>
                <mat-option [value]="null">All</mat-option>
                <mat-option *ngFor="let data of universityList"
                  [value]="data.aisheId">{{data.universityName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="col-md-1" *ngIf="!selfDetailsLevel3">
            <mat-form-field class="d-block">
              <mat-label>From Date:</mat-label>
              <input matInput [matDatepicker]="picker1" readonly [max]="maxDate" [(ngModel)]="fromDate"
                placeholder="From Date" (dateChange)="handleToDate($event)">
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker-toggle matSuffix (click)="clearStartDate()">
                <mat-icon matDatepickerToggleIcon>clear</mat-icon>
            </mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-1" *ngIf="!selfDetailsLevel3">
            <mat-form-field class="d-block">
              <mat-label>To Date:</mat-label>
              <input matInput [matDatepicker]="picker2" readonly [min]="minDate" [max]="maxDate" [(ngModel)]="toDate"
                placeholder="To Date">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker-toggle matSuffix (click)="clearEndDate()">
                <mat-icon matDatepickerToggleIcon>clear</mat-icon>
            </mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="col-md-2" *ngIf="!selfDetailsLevel3">
            <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
              (click)="selfUserDetail('find')">
              <i class="fa fa-search" aria-hidden="true"></i></button>

              <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
            (click)="reset('level3')">
            <i class="fa fa-refresh" aria-hidden="true"></i></button> 
          </div>
          <!-- <div class="col-md-1" *ngIf="!selfDetailsLevel2">
            <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
            (click)="reset('level3')">
            <i class="fa fa-refresh" aria-hidden="true"></i></button>
              
          </div> -->
          <!-- <div class="col-md-1" *ngIf="!selfDetailsLevel3">
              <button mat-button class="btn btn-sm btn-danger d-block mt-3" matTooltip="Refresh" (click)="reload()">
                <i class="fa fa-refresh" aria-hidden="true"></i>
              </button>
            </div> -->
        </div>
      </div>
    </mat-tab>
    <mat-tab label="DEO's">
      <div class="animated fadeInDown card bg-light" *ngIf="deoApplicable">
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2 pt-4">
            <label>Show</label>&nbsp;
            <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
              <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
            </select>
            entries
          </div>
          <div class="col-md-5"></div>
          <div class="col-md-5 pt-4">
            <label>Search:</label>&nbsp;
            <input type="text" size="40" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
              [(ngModel)]="searchText">
          </div>
        </div>
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2" *ngIf="deoLevel && deoLevel.length">
            <mat-form-field class="d-block">
              <mat-label>Select DEO Officer</mat-label>
              <mat-select placeholder="Select Officers" [(ngModel)]="officers">
                <mat-option *ngFor="let item of deoLevel" [value]="item.id">{{item.roleName}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <mat-form-field class="d-block">
              <mat-label>Registration Status</mat-label>
              <mat-select placeholder="Select Registration Status" [(ngModel)]="userStatus">
                <mat-option *ngFor="let item of statuslist" [value]="item.id">{{item.status}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
              (click)="getuserListLevelDeo('find')">
              <i class="fa fa-search" aria-hidden="true"></i></button>

              <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
              (click)="reset('deo')" *ngIf="!selfDetailsLevel2">
              <i class="fa fa-refresh" aria-hidden="true"></i></button> 
          </div>
          <!-- <div class="col-md-1" *ngIf="!selfDetailsLevel2">
            <button mat-button class="btn btn-primary btn-sm d-block mt-2 inline" matTooltip="Reset"
            (click)="reset('deo')">
            <i class="fa fa-refresh" aria-hidden="true"></i></button>
              
          </div> -->
          <!-- <div class="col-md-1">
              <button mat-button class="btn btn-sm btn-danger d-block mt-3" matTooltip="Refresh" (click)="reload()">
                <i class="fa fa-refresh" aria-hidden="true"></i>
              </button>
            </div> -->
        </div>
      </div>
      <mat-card class="m-1 mt-3" *ngIf="!deoApplicable">
        <h1 class="authorized">You are not authorized for this Tab</h1>
      </mat-card>
    </mat-tab>
    <mat-tab label="SNO">
      <mat-card class="m-1 mt-3" *ngIf="!sno">
        <h1 class="authorized">You are not authorized for this Tab</h1>
      </mat-card>
      <div class="animated fadeInDown card bg-light" *ngIf="sno">
        <div class="row col-md-12 overflow-hidden">
          <div class="col-md-2 pt-4">
            <label>Show</label>&nbsp;
            <select [(ngModel)]="pageSize" (ngModelChange)="onChange($event)">
              <option *ngFor="let data of sharedService.pageSizeOptions" [value]="data">{{data}}</option>
            </select>
            entries
          </div>
          <div class="col-md-5"></div>
          <div class="col-md-5 pt-4">
            <label>Search:</label>&nbsp;
            <input type="text" size="40" id='myInput' (change)="updateResults()" (keyup)="updateResults()"
              [(ngModel)]="searchText">
          </div>
        </div>
        <div class="row col-md-12 overflow-hidden" *ngIf="isUserStatus">
          <div class="col-md-2">
            <mat-form-field class="d-block">
              <mat-label>Registration Status</mat-label>
              <mat-select placeholder="Select Registration Status" [(ngModel)]="userStatus">
                <mat-option *ngFor="let item of statuslist" [value]="item.id">{{item.status}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2" *ngIf="isState">
            <mat-form-field class="d-block">
              <mat-label>State</mat-label>
              <mat-select placeholder="--Select State--" [(ngModel)]="stateCode">
                <mat-select-filter [array]="stateListArray" [displayMember]="'name'"
                  (filteredReturn)="stateList = $event">
                </mat-select-filter>
                <mat-option [value]="0">ALL</mat-option>
                <mat-option *ngFor="let data of stateList" [value]="data.stateCode">{{data.name}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <button mat-button class="btn btn-success btn-sm mt-2" matTooltip="Search"
              (click)="getuserListSno('find')">
              <i class="fa fa-search" aria-hidden="true"></i></button>
              <button mat-button class="btn btn-primary btn-sm mt-2 ml-2" matTooltip="Reset"
              (click)="reset('sno')"  *ngIf="!selfDetailsLevel2">
              <i class="fa fa-refresh" aria-hidden="true"></i></button>
          </div>
          <!-- <div class="col-md-1" *ngIf="!selfDetailsLevel2">
            <button mat-button class="btn btn-primary btn-sm d-block mt-2 inline" matTooltip="Reset"
            (click)="reset('sno')">
            <i class="fa fa-refresh" aria-hidden="true"></i></button>
              
          </div> -->
          <!-- <div class="col-md-1">
              <button mat-button class="btn btn-sm btn-danger d-block mt-3" matTooltip="Refresh" (click)="reload()">
                <i class="fa fa-refresh" aria-hidden="true"></i>
              </button>
            </div> -->
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>

  <div class="animated fadeInDown card mb-2 pb-1 pt-1 bg-light overflow-hidden"
    *ngIf="(selectedIndex === 0 && !selfDetailsLevel1)  || (selectedIndex === 1  || selectedIndex === 2) || (selectedIndex === 3 && deoApplicable) || (selectedIndex === 4 && sno) ">
    <div class="col-md-12 table-responsive">
      <table class="table table-bordered table-sm">
        <tr>
          <th>S.No.</th>
          <th>User Id</th>
          <th>User Name</th>
          <th *ngIf="(selectedIndex === 1 || selectedIndex === 2) && showAisheCode">AISHE Code</th>
          <th *ngIf="showUniversity">University Name</th>
          <th *ngIf="selectedIndex === 2 || selectedIndex === 3">Institutions Name</th>
          <th *ngIf="selectedIndex === 2 && officers?.toString() === sharedService.role['College']">University</th>
          <th>State Name</th>
          <th>Mobile</th>
          <th>E-mail</th>
          <th>Status</th>
          <th>Action</th>

        </tr>
        <ng-container *ngFor="let item of userData | paginate : {
          itemsPerPage: pageSize,
          currentPage: page
        
        };
  let i = index
  ">
          <tr>
            <td>{{i+StartLimit+1}}</td>
            <td>{{item.userId}}</td>
            <td>{{item.fullName}}</td>
            <td *ngIf="(selectedIndex === 1 || selectedIndex === 2) && showAisheCode">{{item.aisheCode}}</td>
            <td *ngIf="showUniversity">{{item.universityName}}</td>
            <td *ngIf="selectedIndex === 2 || selectedIndex === 3">{{item.instituteName?item.instituteName:(item.universityName?item.universityName:'')}}</td>
            <td *ngIf="selectedIndex === 2 && officers?.toString() === sharedService.role['College']">{{item.universityName}}</td>
            <td>{{item.stateName}}</td>
            <td>{{item.mobile}}</td>
            <td>{{item.emailId}}</td>
            <td>{{item.userStatusName}}</td>
            <td class="actionHeader">
              <mat-icon class="view_icon" matTooltip="View" (click)="openConfirmDialog(item,'view')">
                remove_red_eye</mat-icon>
                <ng-container *ngIf="showEdit">
                <mat-icon class="view_icon_edit" *ngIf="item.userStatus === 2" matTooltip="edit" color="primary" (click)="openUserDialog(item)">
                  edit</mat-icon>
                </ng-container>
              <span *ngIf="!hideAction">
                <mat-icon class="delete_icon" matTooltip="{{item.userStatus===3?'Activate':'Approve/Disapprove'}}"
                  *ngIf="item.userStatus === 1 || item.userStatus=== 3" (click)="openConfirmDialog(item,'action')">
                  check_circle
                </mat-icon>
                <mat-icon class="delete_icon" matTooltip="{{item.userStatus===2?'Inactivate':'Activate'}}"
                  *ngIf="item.userStatus === 2 || item.userStatus === 4" (click)="openConfirmDialog(item,'action')">
                  highlight_off
                </mat-icon>
              </span>
            </td>  
          </tr>
        </ng-container>
      </table>
    </div>
    <div class="row col-md-12 overflow-hidden">
      <div class="col-md-3">
        Showing {{StartLimit + 1}} to {{pageData === -1?0:pageData}} Of {{userData.length}}
        entries
      </div>
      <div class="col-md-3"></div>
      <div class="col-md-6" *ngIf="userData.length !== 0">
        <pagination-controls previousLabel="Prev" nextLabel="Next" (pageChange)="handlePageChange($event)"
          screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
          screenReaderCurrentLabel="You're on page"></pagination-controls>
      </div>
    </div>
  </div>
</div>